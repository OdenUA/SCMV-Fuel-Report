# SCMV Fuel Report

Веб-приложение для анализа расхода топлива и событий (заправки/сливы) на основе данных GPS-трекинга.

## Возможности

- **Подключение по WebSocket**: Работает в реальном времени с сервером `scmv.vpngps.com`.
- **Визуализация**:
  - Интерактивная карта (Leaflet) с отображением трека и событий.
  - График уровня топлива (Chart.js) с возможностью масштабирования.
- **Аналитика**:
  - Автоматическое определение заправок и сливов.
  - Умная фильтрация "медленных" заправок и колебаний топлива.
  - Расчет общего пробега, расхода и среднего расхода на 100 км.
- **Настройки**:
  - Настраиваемые пороги для определения заправок и сливов.
  - Фильтрация нулевых значений.
  - Логика "Зажигания" (игнорирование сливов на высокой скорости).

## Установка и Запуск

1. Скачайте репозиторий:
   ```bash
   git clone https://github.com/OdenUA/SCMV-Fuel-Report.git
   ```
2. Откройте файл `index.html` в любом современном браузере.
   - Не требуется установка Node.js или веб-сервера (работает локально).

## Использование

1. **Вход**:
   - Введите логин и пароль.
   - Нажмите "Подключиться" (или дождитесь авто-подключения, если данные сохранены).
2. **Выбор объекта**:
   - После подключения выберите устройство из выпадающего списка.
3. **Загрузка данных**:
   - Выберите период (Дата С / Дата По).
   - Нажмите "Загрузить отчет".
4. **Анализ**:
   - Изучите сводку в верхней части экрана.
   - Используйте график для детального просмотра изменений уровня топлива.
   - Таблица событий показывает список всех заправок и сливов с адресами.

## Структура проекта

- `index.html`: Главная страница.
- `css/style.css`: Стили интерфейса.
- `js/`:
  - `api.js`: Работа с WebSocket и протоколом обмена.
  - `analytics.js`: Алгоритмы обработки данных топлива.
  - `chart.js`: Настройка и отрисовка графика.
  - `map.js`: Работа с картой.
  - `ui.js`: Управление интерфейсом и таблицами.
  - `state.js`: Глобальное состояние приложения.
  - `config.js`: Конфигурация.
  - `utils.js`: Вспомогательные функции.
  - `main.js`: Точка входа и инициализация.

## Разработка

Приложение написано на Vanilla JS (ES6) без использования систем сборки. Использует глобальные переменные для обмена состоянием между модулями (см. `js/state.js`).

### Зависимости (CDN)
- Leaflet (Карты)
- Chart.js (Графики)
- chartjs-plugin-zoom (Зум графика)
- chartjs-adapter-date-fns (Работа с датами в графике)
